---
import Layout from "../layouts/Layout.astro";
import ProjectCard from "../components/ProjectCard.astro"; // AsegÃºrate de importar la tarjeta
import { directus } from '../lib/directus';
import { readItems } from '@directus/sdk';

// 1. OBTENER PROYECTOS DE DIRECTUS
let projects = [];
try {
  projects = await directus.request(readItems('projects', {
    fields: ['slug', 'title', 'image', 'description'], // Solo traemos lo necesario
    filter: { status: { _eq: 'published' } },
    limit: 3 // Solo los 3 destacados
  }));
} catch (error) {
  console.error("Error cargando proyectos en Home:", error);
}
---

<Layout title="Henry Marinho - Portfolio" description="Data Analyst & Developer">
  <main class="w-full max-w-5xl mx-auto p-4 text-white">
    
    <section class="py-20">
      <h1 class="text-5xl font-bold mb-4">Henry <span class="text-blue-500">Marinho</span></h1>
      <p class="text-xl text-gray-400">Data Analyst & IT Project Manager.</p>
    </section>

    <section id="projects" class="py-10">
      <h2 class="text-3xl font-bold mb-8 flex items-center gap-2">
        ðŸš€ Featured Projects
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {projects.length > 0 ? (
          projects.map((project) => (
            <ProjectCard 
              title={project.title}
              description={project.description}
              image={project.image}
              url={`/project/${project.slug}`} 
            />
          ))
        ) : (
          <p class="text-gray-500">No projects found.</p>
        )}
      </div>
    </section>

  </main>
</Layout>